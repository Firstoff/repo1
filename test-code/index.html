<!DOCTYPE html><html lang="ru"><head><a href="https://metrika.yandex.ru/stat/?id=12704569&amp;from=informer" target="_blank" rel="nofollow"><img src="https://informer.yandex.ru/informer/12704569/3_0_E9E5E5FF_C9C5C5FF_0_pageviews" style="width:88px; height:31px; border:0;" alt="Яндекс.Метрика" title="Яндекс.Метрика: данные за сегодня (просмотры, визиты и уникальные посетители)" class="ym-advanced-informer" data-cid="12704569" data-lang="ru"></a><script type="text/javascript">(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
   m[i].l=1*new Date();
   for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
   k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
   (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

   ym(12704569, "init", {
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true,
        webvisor:true
   });</script><noscript><div><img src="https://mc.yandex.ru/watch/12704569" style="position:absolute; left:-9999px;" alt=""></div></noscript><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Парсинг 1CV8Clst.lst - Cyberflat.ru</title><meta name="description" content="# Путь к файлу 1CV8Clst.lst $clusterFile = 'C:\code\PowerShell\1c\1CV8Clst.lst' if (-not (Test-Path $clusterFile)) { Write-Error 'Файл $clusterFile не найден!' exit 1 } $data = Get-Content -Path $clusterFile -Raw # Функция для точного извлечения ClusterServer из начала файла function Get-ClusterServer { param ($content) # Ищем конкретную структуру&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="stylesheet" href="https://cyberflat.ru/media/plugins/syntaxHighlighter/prism-black.css"><link rel="canonical" href="https://cyberflat.ru/test-code/"><link rel="alternate" type="application/atom+xml" href="https://cyberflat.ru/feed.xml" title="Cyberflat.ru - RSS"><link rel="alternate" type="application/json" href="https://cyberflat.ru/feed.json" title="Cyberflat.ru - JSON"><link rel="shortcut icon" href="https://cyberflat.ru/media/website/favicon.ico" type="image/x-icon"><link rel="preload" href="https://cyberflat.ru/assets/dynamic/fonts/publicsans/publicsans.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="https://cyberflat.ru/assets/dynamic/fonts/oswald/oswald.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://cyberflat.ru/assets/css/style.css?v=53c9fbad2d84d7d4e90d8cca8f8ffe58"><link rel="stylesheet" href="https://cyberflat.ru/assets/css/prism.css?v=20dd6e72a01fd3cd26104178888ad8eb"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://cyberflat.ru/test-code/"},"headline":"Парсинг 1CV8Clst.lst","datePublished":"2025-08-13T01:43+03:00","dateModified":"2025-08-13T01:49+03:00","image":{"@type":"ImageObject","url":"https://cyberflat.ru/media/posts/34/2023-10-18-14-06-54-2-2xl.webp","height":1832,"width":1600},"description":"# Путь к файлу 1CV8Clst.lst $clusterFile = 'C:\\code\\PowerShell\\1c\\1CV8Clst.lst' if (-not (Test-Path $clusterFile)) { Write-Error 'Файл $clusterFile не найден!' exit 1 } $data = Get-Content -Path $clusterFile -Raw # Функция для точного извлечения ClusterServer из начала файла function Get-ClusterServer { param ($content) # Ищем конкретную структуру&hellip;","author":{"@type":"Person","name":"Korchagin","url":"https://cyberflat.ru/authors/korchagin/"},"publisher":{"@type":"Organization","name":"Korchagin"}}</script><noscript><style>img[loading] {
					opacity: 1;
				}</style></noscript></head><body><header class="topbar" id="js-header"><div class="topbar__inner"><a class="logo" href="https://cyberflat.ru/">Cyberflat.ru</a><nav class="navbar"><button class="navbar__toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://cyberflat.ru/eshche-nemnogo-kotov-iz-ai/" target="_self">others_ai_cats</a></li><li><a href="https://cyberflat.ru/testovaya-pervaya-stranica-na-publii/" target="_self">first</a></li></ul></nav></div></header><div class="content"><div class="infobar"><div class="infobar__update">Last Updated: <time datetime="2025-08-13T01:50">13 авг. 2025</time></div><div class="infobar__search"></div></div><main class="main"><article class="post"><figure class="post__featured-image"><img src="https://cyberflat.ru/media/posts/34/2023-10-18-14-06-54-2-2xl.webp" srcset="https://cyberflat.ru/media/posts/34/responsive/2023-10-18-14-06-54-2-2xl-xs.webp 300w, https://cyberflat.ru/media/posts/34/responsive/2023-10-18-14-06-54-2-2xl-sm.webp 480w, https://cyberflat.ru/media/posts/34/responsive/2023-10-18-14-06-54-2-2xl-md.webp 768w, https://cyberflat.ru/media/posts/34/responsive/2023-10-18-14-06-54-2-2xl-lg.webp 1024w, https://cyberflat.ru/media/posts/34/responsive/2023-10-18-14-06-54-2-2xl-xl.webp 1360w, https://cyberflat.ru/media/posts/34/responsive/2023-10-18-14-06-54-2-2xl-2xl.webp 1600w" sizes="(max-width: 1600px) 100vw, 1600px" loading="eager" height="1832" width="1600" alt=""></figure><header class="u-header post__header"><h1>Парсинг 1CV8Clst.lst</h1><div class="u-header__meta u-small"><div><a href="https://cyberflat.ru/authors/korchagin/" title="Korchagin">Korchagin</a> <time datetime="2025-08-13T01:43">13 авг. 2025 </time><a href="https://cyberflat.ru/tags/1c/" class="u-tag u-tag--1">1C</a></div></div></header><div class="post__entry u-inner"><div><div># Путь к файлу 1CV8Clst.lst</div><div>$clusterFile = "C:\code\PowerShell\1c\1CV8Clst.lst"</div><br><div>if (-not (Test-Path $clusterFile)) {</div><div>    Write-Error "Файл $clusterFile не найден!"</div><div>    exit 1</div><div>}</div><br><div>$data = Get-Content -Path $clusterFile -Raw</div><br><div># Функция для точного извлечения ClusterServer из начала файла</div><div>function Get-ClusterServer {</div><div>    param ($content)</div><div>   </div><div>    # Ищем конкретную структуру в начале файла с учетом дефиса в имени</div><div>    $pattern = '{\s*0,[^{]+{[^}]+"[^"]*-\d*"[^}]*{[^}]*"([^"-]+-[^"]+)",\s*(\d+)'</div><div>    $match = [regex]::Match($content, $pattern)</div><div>   </div><div>    if ($match.Success) {</div><div>        $server = $match.Groups[1].Value.Trim()</div><div>        $port = $match.Groups[2].Value.Trim()</div><div>        return "${server}:${port}"</div><div>    }</div><div>    else {</div><div>        # Дополнительная попытка найти альтернативный формат</div><div>        $altPattern = '{\s*0,[^{]+{[^}]+"([^"-]+-[^"]+)",\s*(\d+)'</div><div>        $altMatch = [regex]::Match($content, $altPattern)</div><div>       </div><div>        if ($altMatch.Success) {</div><div>            $server = $altMatch.Groups[1].Value.Trim()</div><div>            $port = $altMatch.Groups[2].Value.Trim()</div><div>            return "${server}:${port}"</div><div>        }</div><div>    }</div><div>   </div><div>    Write-Warning "Не удалось определить ClusterServer в файле"</div><div>    return "Unknown:0"</div><div>}</div><br><div>$clusterServer = Get-ClusterServer -content $data</div><div>Write-Host "Определен ClusterServer: $clusterServer" -ForegroundColor Cyan</div><br><div># Парсинг баз данных</div><div>$dbPattern = '\{[0-9a-f-]+,"[^"]+","[^"]+","[^"]+","[^"]+","[^"]+"[^}]*\}'</div><div>$dbMatches = [regex]::Matches($data, $dbPattern)</div><br><div>$result = @()</div><br><div>foreach ($match in $dbMatches) {</div><div>    $block = $match.Value</div><div>    $fields = $block -split ',' | ForEach-Object { $_.Trim('"{}') }</div><div>   </div><div>    if ($fields.Count -ge 6) {</div><div>        $dbName = $fields[2]</div><div>        $dbmsType = $fields[3]</div><div>        $sqlServer = $fields[4]</div><div>        $dbNameInSql = $fields[5]</div><div>       </div><div>        $connStringPart = $fields[8]</div><div>        $dbsrvr = if ($connStringPart -match 'DBSrvr=([^;]+)') { $matches[1] } else { $sqlServer }</div><div>       </div><div>        $result += [PSCustomObject]@{</div><div>            BaseName      = $dbName</div><div>            DBMS          = $dbmsType</div><div>            SQLServer     = $dbsrvr</div><div>            DBNameInSQL   = $dbNameInSql</div><div>            ClusterServer = $clusterServer</div><div>        }</div><div>    }</div><div>}</div><br><div># Вывод результатов</div><div>$result | Format-Table -AutoSize</div><br><div># Экспорт в CSV</div><div>#$csvPath = Join-Path (Split-Path $clusterFile) "1C_Databases_Report_$(Get-Date -Format 'yyyyMMdd_HHmmss').csv"</div><div>#$result | Export-Csv -Path $csvPath -NoTypeInformation -Encoding UTF8 -Force</div><div>#Write-Host "Отчет сохранен в $csvPath" -ForegroundColor Green</div></div></div><aside class="post__aside"><div class="post__last-updated u-small">This article was updated on 13 авг. 2025</div><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fcyberflat.ru%2Ftest-code%2F" class="js-share facebook" title="Share with Facebook" rel="nofollow noopener noreferrer" aria-label="Share with Facebook"><svg class="u-icon"><use xlink:href="https://cyberflat.ru/assets/svg/svg-map.svg#facebook"/></svg> </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fcyberflat.ru%2Ftest-code%2F&amp;media=https%3A%2F%2Fcyberflat.ru%2Fmedia%2Fposts%2F34%2F2023-10-18-14-06-54-2-2xl.webp&amp;description=%D0%9F%D0%B0%D1%80%D1%81%D0%B8%D0%BD%D0%B3%201CV8Clst.lst" class="js-share pinterest" title="Share with Pinterest" rel="nofollow noopener noreferrer" aria-label="Share with Pinterest"><svg class="u-icon"><use xlink:href="https://cyberflat.ru/assets/svg/svg-map.svg#pinterest"/></svg> </a><a href="https://wa.me/?text=%D0%9F%D0%B0%D1%80%D1%81%D0%B8%D0%BD%D0%B3%201CV8Clst.lst https%3A%2F%2Fcyberflat.ru%2Ftest-code%2F" class="js-share whatsapp" rel="nofollow noopener noreferrer" title="Share with WhatsApp" aria-label="Share with WhatsApp"><svg class="u-icon"><use xlink:href="https://cyberflat.ru/assets/svg/svg-map.svg#whatsapp"/></svg> </a><a href="https://t.me/share/url?url=https%3A%2F%2Fcyberflat.ru%2Ftest-code%2F&amp;text=%D0%9F%D0%B0%D1%80%D1%81%D0%B8%D0%BD%D0%B3%201CV8Clst.lst" class="js-share telegram" target="_blank" rel="nofollow noopener noreferrer" aria-label="Share with Telegram"><svg class="u-icon"><use xlink:href="https://cyberflat.ru/assets/svg/svg-map.svg#telegram"/></svg></a></div></aside><footer class="post__footer"><ul class="post__tag box"><li><a href="https://cyberflat.ru/tags/1c/" class="u-tag u-tag--1" title="1C">1C</a></li></ul><nav class="post__nav box"><div class="post__nav__prev"><a href="https://cyberflat.ru/soft-touch/" class="post__nav__link" rel="prev"><img src="https://cyberflat.ru/media/posts/32/responsive/DSC_0089_004-kopiya-xs.JPG" loading="lazy" alt="" height="1440" width="2160"><div class="u-small">Previous Post<h5>Soft-touch</h5></div></a></div></nav></footer></article><div class="comments-area box"></div></main><div class="sidebar"><section class="box"><h3 class="box__title">Follow us</h3><div class="follow"><a href="https://www.youtube.com/@cyberflat_ru6118/videos" class="youtube" aria-label="Youtube"><svg class="u-icon"><use xlink:href="https://cyberflat.ru/assets/svg/svg-map.svg#youtube"/></svg> Youtube </a><a href="https://telegram.me/share/url?url&#x3D;t.me/cyberflat" class="telegram" aria-label="Telegram"><svg class="u-icon"><use xlink:href="https://cyberflat.ru/assets/svg/svg-map.svg#telegram"/></svg> Telegram</a></div></section><section class="box"><h3 class="box__title">Tags</h3><ul class="tags"><li><a href="https://cyberflat.ru/tags/1c/">1C</a> <span class="u-small">(1)</span></li><li><a href="https://cyberflat.ru/tags/agrofitness/">agrofitness</a> <span class="u-small">(4)</span></li><li><a href="https://cyberflat.ru/tags/cats/">cats</a> <span class="u-small">(12)</span></li><li><a href="https://cyberflat.ru/tags/chatgpt/">chatgpt</a> <span class="u-small">(1)</span></li><li><a href="https://cyberflat.ru/tags/cyberpunk/">cyberpunk</a> <span class="u-small">(3)</span></li></ul></section></div><footer class="footer"><a class="footer__logo" href="https://cyberflat.ru/">Cyberflat.ru</a><nav><ul class="footer__nav"></ul></nav><div class="footer__follow"><a href="https://www.youtube.com/@cyberflat_ru6118/videos" aria-label="Youtube"><svg><use xlink:href="https://cyberflat.ru/assets/svg/svg-map.svg#youtube"/></svg></a></div><div class="footer__copyright"><p>Powered by cyberflat.ru</p></div></footer></div><script defer="defer" src="https://cyberflat.ru/assets/js/prism.js?v=73c36e5c6bde9048f51586dda5708dd9"></script><script>window.publiiThemeMenuConfig = {    
        mobileMenuMode: 'sidebar',
        animationSpeed: 300,
        submenuWidth: 'auto',
        doubleClickTime: 500,
        mobileMenuExpandableSubmenus: true, 
        relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://cyberflat.ru/assets/js/scripts.min.js?v=ef33954c8f912e6c18ee116825aadc90"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script><script defer="defer" src="https://cyberflat.ru/media/plugins/syntaxHighlighter/prism.js"></script></body></html>